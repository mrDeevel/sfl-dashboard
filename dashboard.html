<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SFL Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Titillium+Web:wght@400;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles/dashboard.css" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="icon" type="image/png" href="assets/sfl-logo.png" />
</head>
<body>
  <!-- Sidenav Trigger as Floating Action Button -->
  <div class="fixed-action-btn" style="top:32px;right:32px;position:fixed;z-index:1000;">
    <a href="#" data-target="slide-out" class="sidenav-trigger btn-floating btn-large blue">
      <i class="material-icons">menu</i>
    </a>
  </div>

  <!-- Materialize Sidenav -->
  <ul id="slide-out" class="sidenav">
    <li>
      <div class="user-view">
        <div class="background" style="background: #1976d2;">
          <img src="assets/sfl-logo.png" alt="SFL Logo" style="max-width: 80px; margin: 16px auto; display: block; background: white; border-radius: 50%;">
        </div>
        <a href="#user"><img class="circle" id="side-avatar" src="assets/sfl-logo.png"></a>
        <a href="#name"><span class="white-text name" id="side-team-name">Team</span></a>
      </div>
    </li>
    <li><a href="dashboard.html"><i class="material-icons">dashboard</i>Dashboard</a></li>
    <li><a href="#draft-progress-section" onclick="loadDraftProgress()"><i class="material-icons">flag</i>Draft Progress</a></li>
    <li><a href="#!"><i class="material-icons">assignment</i>Reports</a></li>
    <li><a href="#!"><i class="material-icons">settings</i>Settings</a></li>

    <!-- Manager section inserted here when enabled -->
    <li id="manager-section-divider" style="display:none;"><div class="divider"></div></li>
    <div id="manager-section" style="display:none;"></div>

    <li><div class="divider"></div></li>
    <li><a href="#!" onclick="logoutSFL()"><i class="material-icons">logout</i>Logout</a></li>
  </ul>


  <div class="main-content">
    <!-- Welcome banner with team avatar and name -->
    <section class="welcome-banner center-banner">
      <img id="team-avatar" src="assets/avatars/default.png" alt="Team avatar" class="avatar" />
    </section>

    <!-- Recent Picks Sidebar/Section -->
    <aside id="recent-picks-section" class="recent-picks-card-section">
      <h5>Recent Picks</h5>
      <div id="recent-picks-cards">
        <!-- Recent pick cards will be injected here -->
      </div>
    </aside>

    <!-- Draft Progress Section -->
    <section id="draft-progress-section" class="hidden-section draft-progress-main">
      <h4>Draft Progress</h4>
      <div id="draft-summary-tiers" class="draft-progress-rows">
        <div class="draft-summary-row">
          <!-- League progress bars will be rendered here by JS -->
        </div>
      </div>
      <!-- User League Pick Card -->
      <div id="user-league-pick-card" class="card user-league-pick-card" style="margin:24px auto 0 auto;max-width:420px;display:none;">
        <div class="card-content">
          <span class="card-title" id="user-league-title">Your League Status</span>
          <div id="user-league-pick-info">
            <!-- JS will inject: League, current pick, picks until user is on the clock -->
          </div>
        </div>
      </div>
    </section>

    <!-- Draft Picks Modal -->
    <div id="draft-picks-modal" class="modal">
      <div class="modal-content">
        <h4 id="modal-league-title"></h4>
        <ul id="modal-draft-picks" class="collection"></ul>
      </div>
      <div class="modal-footer">
        <button class="modal-close btn waves-effect waves-light">Close</button>
      </div>
    </div>

    <!-- Manager Login Modal -->
    <div id="manager-code-modal" class="modal">
      <div class="modal-content">
        <h5>Manager Login</h5>
        <p>Enter manager code:</p>
        <input id="managerCodeInput" type="password" class="validate" autocomplete="off" />
        <span id="managerCodeError" style="color:red;display:none;">Incorrect code. Try again.</span>
      </div>
      <div class="modal-footer">
        <a href="#!" id="managerCodeSubmit" class="modal-close waves-effect waves-green btn-flat">Submit</a>
      </div>
    </div>
  </div>



  <script src="scripts/dashboard.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  <!-- Dual Ticker at Bottom -->
  <div id="dual-ticker" class="dual-ticker">
    <div class="ticker-header-container">
      <div class="ticker-header-content" id="ticker-header-content">
        <!-- Ticker header will be injected here -->
      </div>
    </div>
    <div class="ticker-item-container">
      <div class="ticker-item-content" id="ticker-item-content">
        <!-- Ticker item will be injected here -->
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      var elems = document.querySelectorAll('.sidenav');
      M.Sidenav.init(elems);
      var menuBtn = document.querySelector('.fixed-action-btn .sidenav-trigger');
      var sidenav = document.querySelector('.sidenav');
      if (menuBtn && sidenav) {
        let lastClick = 0;
        menuBtn.addEventListener('click', function(e) {
          e.preventDefault();
          var instance = M.Sidenav.getInstance(sidenav);
          const now = Date.now();
          // Prevent double open/close by debouncing
          if (instance.isOpen) {
            if (now - lastClick > 300) {
              instance.close();
              lastClick = now;
            }
          } else {
            instance.open();
            lastClick = now;
          }
        });
      }
    });
  </script>
</body>
</html>